<div class="page-container">
  <header class="page-header">
    <div class="header-left">
      <h1>Audit Logs</h1>
      <p class="subtitle">Track user actions, system events, and claim workflow changes.</p>
    </div>
  </header>

  <!-- Toolbar (Search + Filters) -->
  <div class="toolbar">
    <div class="search-bar">
      <span class="search-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
          <path
            d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12A6 6 0 0110 4z" />
        </svg>
      </span>
      <input type="text" [(ngModel)]="searchTerm" placeholder="Search by time, user, action, entity, or status..."
        aria-label="Search audit logs" />
    </div>



    <div class="sort-controls">
      <label>Sort by:</label>
      <button (click)="setSort('time')">Time</button>
      <button (click)="setSort('user')">User</button>
      <button (click)="setSort('action')">Action</button>
      <button (click)="setSort('entity')">Entity</button>
      <button (click)="setSort('status')">Status</button>
    </div>

  </div>

  <!-- Timeline -->
  <mat-card class="card logs-card">
    <div class="logs-header">
      <h2>Timeline</h2>
      <div class="actions">
        <button class="action-btn" (click)="export('csv')" [disabled]="exporting">
          <mat-icon>table_view</mat-icon> CSV
        </button>
        <button class="action-btn" (click)="export('pdf')" [disabled]="exporting">
          <mat-icon>picture_as_pdf</mat-icon> PDF
        </button>
      </div>
    </div>

    <!-- Success banner -->
    <div *ngIf="exportSuccess" class="success-banner">
      <mat-icon>check_circle</mat-icon>
      Export completed successfully.
    </div>

    <table mat-table [dataSource]="filteredLogs()" class="logs-table">
      <ng-container matColumnDef="time">
        <th mat-header-cell *matHeaderCellDef>Time</th>
        <td mat-cell *matCellDef="let l">{{ l.time }}</td>
      </ng-container>

      <ng-container matColumnDef="user">
        <th mat-header-cell *matHeaderCellDef>User</th>
        <td mat-cell *matCellDef="let l">{{ l.user }}</td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let l">{{ l.action }}</td>
      </ng-container>

      <ng-container matColumnDef="entity">
        <th mat-header-cell *matHeaderCellDef>Entity</th>
        <td mat-cell *matCellDef="let l">{{ l.entity }}</td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let l">
          <span class="status" [class.success]="l.status==='Success'" [class.pending]="l.status==='Pending'"
            [class.queued]="l.status==='Queued'" [class.sent]="l.status==='Sent'">
            {{ l.status }}
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['time','user','action','entity','status']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['time','user','action','entity','status'];"></tr>
    </table>
  </mat-card>
</div>