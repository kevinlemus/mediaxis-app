<div class="page-container">
  <h1>User Management</h1>
  <div class="um-grid">
    <mat-card class="invite-card">
      <h2>Invite User</h2>
      <form class="invite-form" (ngSubmit)="submitInvite()" #f="ngForm">
        <mat-form-field appearance="outline">
          <mat-label>Name</mat-label>
          <input matInput name="name" [(ngModel)]="inviteForm.name" required />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput name="email" [(ngModel)]="inviteForm.email" required type="email" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Role</mat-label>
          <mat-select name="role" [(ngModel)]="inviteForm.role" required>
            <mat-option *ngFor="let r of roles" [value]="r.value">{{ r.label }}</mat-option>
          </mat-select>
        </mat-form-field>
        <button mat-raised-button color="primary" [disabled]="inviting || f.invalid">
          <mat-icon *ngIf="!inviting">person_add</mat-icon>
          <mat-icon *ngIf="inviting">hourglass_empty</mat-icon>
          <span>{{ inviting ? 'Sending...' : 'Send Invite' }}</span>
        </button>
      </form>
    </mat-card>

    <mat-card class="users-card">
      <h2>Accounts</h2>
      <table mat-table [dataSource]="users" class="users-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let u">{{ u.name }}</td>
        </ng-container>
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Email</th>
          <td mat-cell *matCellDef="let u">{{ u.email }}</td>
        </ng-container>
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef>Role</th>
          <td mat-cell *matCellDef="let u"><span class="role-badge" [class.manager]="u.role==='billing-manager'" [class.auditor]="u.role==='auditor'">{{ roleBadge(u.role) }}</span></td>
        </ng-container>
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let u"><span class="status" [class.invited]="u.status==='Invited'" [class.suspended]="u.status==='Suspended'">{{ u.status }}</span></td>
        </ng-container>
        <ng-container matColumnDef="last">
          <th mat-header-cell *matHeaderCellDef>Last Login</th>
          <td mat-cell *matCellDef="let u">{{ u.lastLogin }}</td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let u">
            <button mat-icon-button [matMenuTriggerFor]="menu"><mat-icon>more_vert</mat-icon></button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item (click)="activate(u)"><mat-icon>check_circle</mat-icon><span>Activate</span></button>
              <button mat-menu-item (click)="suspend(u)"><mat-icon>pause_circle</mat-icon><span>Suspend</span></button>
              <button mat-menu-item (click)="revoke(u)"><mat-icon>block</mat-icon><span>Revoke</span></button>
            </mat-menu>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="['name','email','role','status','last','actions']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['name','email','role','status','last','actions'];"></tr>
      </table>
    </mat-card>

    <mat-card class="roles-card">
      <h2>Role Definitions</h2>
      <ul class="role-list">
        <li><strong>Staff:</strong> Create & submit claims.</li>
        <li><strong>Billing Manager:</strong> Review & resubmit, manage payers.</li>
        <li><strong>Auditor:</strong> Read-only access to claims & logs.</li>
      </ul>
    </mat-card>
  </div>
</div>
