<div class="content-grid">
  <!-- Left: Upload + status -->
  <section class="upload-section card">
    <header class="page-header">
      <h1>Upload Encounter File</h1>
      <p class="instructions">
        Upload patient encounter notes in CSV or PDF format. MediAxis will process
        billing codes and auto‑fill claim forms.
      </p>
    </header>

    <div class="upload-box">
      <label for="fileUpload" class="upload-label">
        <span *ngIf="!uploadedFile">
          Drag & drop or click to upload CSV/PDF
        </span>
        <span *ngIf="uploadedFile">{{ uploadedFile.name }}</span>
      </label>
      <input id="fileUpload" type="file" (change)="onFileSelected($event)" />
    </div>

    <div *ngIf="isProcessing" class="processing">
      <p>MediAxis AI is processing your file…</p>
    </div>

    <div class="helpers">
      <span class="hint">Supported: CSV, PDF</span>
      <button class="link" type="button" (click)="resetForm()" [disabled]="isProcessing">
        Clear selection
      </button>
    </div>
  </section>

  <!-- Right: Preview panel -->
  <section class="preview-section card">
    <header class="preview-header">
      <h2>Claim preview</h2>
      <span class="status-chip" [class.ready]="uploadedFile && !isProcessing" [class.pending]="!uploadedFile || isProcessing">
        {{ isProcessing ? 'Processing' : (uploadedFile ? 'Ready' : 'Awaiting file') }}
      </span>
    </header>

    <!-- Empty state -->
    <div *ngIf="!uploadedFile && !isProcessing" class="empty-state">
      <p>No file uploaded yet.</p>
      <p class="subtext">Upload an encounter file to generate a preview and edit before submitting.</p>
    </div>

    <!-- Form preview -->
    <form *ngIf="uploadedFile && !isProcessing" class="preview-form" (ngSubmit)="submitClaim()">
      <div class="form-grid">
        <div class="form-row">
          <label>Patient name</label>
          <input [(ngModel)]="claimForm.patientName" name="patientName" required />
        </div>
        <div class="form-row">
          <label>Date of birth</label>
          <input [(ngModel)]="claimForm.patientDOB" name="patientDOB" type="date" required />
        </div>
        <div class="form-row">
          <label>Insurance provider</label>
          <input [(ngModel)]="claimForm.insuranceProvider" name="insuranceProvider" required />
        </div>
        <div class="form-row">
          <label>Billing code (CPT)</label>
          <input [(ngModel)]="claimForm.billingCode" name="billingCode" pattern="^[0-9A-Za-z\-]{3,10}$" required />
        </div>
        <div class="form-row">
          <label>Diagnosis code (ICD‑10)</label>
          <input [(ngModel)]="claimForm.diagnosisCode" name="diagnosisCode" pattern="^[A-Z0-9\.\-]{3,10}$" required />
        </div>
        <div class="form-row">
          <label>Claim amount ($)</label>
          <input [(ngModel)]="claimForm.claimAmount" name="claimAmount" type="number" min="0" step="0.01" required />
        </div>
      </div>

      <div class="actions">
        <button class="primary" type="submit">Submit claim</button>
        <button class="secondary" type="button" (click)="resetForm()">Reset</button>
        <button class="tertiary" type="button">Download draft</button>
      </div>
    </form>
  </section>
</div>
