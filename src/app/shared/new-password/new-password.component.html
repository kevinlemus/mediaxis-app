<div class="auth-container">
  <div class="auth-card">
    <h1 class="auth-title">Set New Password</h1>
    <p class="instructions">
      Enter and confirm your new password to complete the reset.
    </p>

    <form (ngSubmit)="updatePassword()" #newPasswordForm="ngForm">
      <!-- New password field -->
      <mat-form-field appearance="fill" class="auth-field">
        <mat-label>New password</mat-label>
        <input
          matInput
          [(ngModel)]="newPassword"
          name="newPassword"
          type="password"
          required
          minlength="8"
          pattern="^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$%^&*]).+$"
          placeholder="Enter new password"
          #newPass="ngModel"
        />
        <mat-error *ngIf="newPass.errors?.['required']">
          This field is required.
        </mat-error>
        <mat-error *ngIf="newPass.errors?.['minlength']">
          Password must be at least 8 characters.
        </mat-error>
        <mat-error *ngIf="newPass.errors?.['pattern']">
          Include uppercase, lowercase, a number, and a special character.
        </mat-error>
      </mat-form-field>

      <!-- Confirm password field -->
      <mat-form-field appearance="fill" class="auth-field">
        <mat-label>Confirm password</mat-label>
        <input
          matInput
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          type="password"
          required
          placeholder="Re-enter new password"
          #confirmPass="ngModel"
        />
        <mat-error *ngIf="confirmPass.errors?.['required']">
          This field is required.
        </mat-error>
      </mat-form-field>

      <div class="auth-actions">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="!newPasswordForm.valid || isSubmitting"
        >
          {{ isSubmitting ? "Updating..." : "Update Password" }}
        </button>
        <a routerLink="/login" class="link">Back to login</a>
      </div>

      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>
    </form>
  </div>
</div>
